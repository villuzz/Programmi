sap.ui.define(["sap/m/Table","epta/ps/model/formatter","sap/ui/model/json/JSONModel","sap/m/Button","sap/m/Label","sap/m/Toolbar","sap/m/ToolbarSpacer"],function(e,t,s,i,l,r,a){"use strict";return e.extend("epta.ps.ui5.m.Table",{metadata:{properties:{showTitle:{type:"boolean",defaultValue:false}}},init:function(){e.prototype.init.apply(this);this["_oFilterModel"+this.sId.substr(this.sId.lastIndexOf("-"))]=new s({items:undefined,filterItems:[]})},onBeforeRendering:function(t){e.prototype.onBeforeRendering.apply(this);this.addStyleClass("eptaTBL");if(typeof this["_oFilterModel"+this.sId.substr(this.sId.lastIndexOf("-"))].getProperty("/items")==="undefined"){this["_oFilterModel"+this.sId.substr(this.sId.lastIndexOf("-"))].setProperty("/items",JSON.parse(JSON.stringify(this._getColumns())))}},_getColumns:function(){var e=[];var t=this.getColumns();if(this.mAggregations.items===undefined||this.mAggregations.items.length===0){return[]}for(var s=0;s<t.length;s++){var i=t[s].getAggregation("header").getProperty("text");if(i==="")continue;var l=this.mAggregations.items[0].mAggregations.cells[s].mBindingInfos;e.push({key:l[Object.keys(l)[0]].binding.sPath,text:t[s].getAggregation("header").getProperty("text")})}return e},isStringNullOrWhiteSpace:function(e){return e===undefined||e===null||typeof e!=="string"||e.match(/^ *$/)!==null},openFilterDialog:function(){var e=this;var t=this["_oDialog"+this.sId.substr(this.sId.lastIndexOf("-"))];var s=this["_oFilterPanel"+this.sId.substr(this.sId.lastIndexOf("-"))];if(typeof t==="undefined"){s=new sap.m.P13nFilterPanel({layoutMode:"Desktop",title:"{i18n>ui5Title}",visible:true,type:"filter"});s.setModel(this["_oFilterModel"+this.sId.substr(this.sId.lastIndexOf("-"))],"filter");s.bindItems("filter>/items",new sap.m.P13nItem({columnKey:"{filter>key}",text:"{filter>text}"}));s.bindFilterItems("filter>/filterItems",new sap.m.P13nFilterItem({key:"{filter>key}",exclude:"{filter>exclude}",columnKey:"{filter>columnKey}",operation:"{filter>operation}",value1:"{filter>value1}",value2:"{filter>value2}"}));s.attachFilterItemChanged(this._onHandleFilterItem,this);t=new sap.m.P13nDialog({initialVisiblePanelType:"filter",ok:function(s){var i=[];var l=JSON.parse(JSON.stringify(e["_oFilterModel"+e.sId.substr(e.sId.lastIndexOf("-"))].getProperty("/filterItems")));for(var r=0;r<l.length;r++){var a=l[r];i.push(new sap.ui.model.Filter({path:a.columnKey,operator:a.exclude===true?sap.ui.model.FilterOperator.NE:l[r].operation,value1:a.value1,value2:a.value2}))}e.getBinding("items").filter(i);t.close()},cancel:function(e){t.close()},showReset:false,panels:s});this["_oDialog"+this.sId.substr(this.sId.lastIndexOf("-"))]=t;this["_oFilterPanel"+this.sId.substr(this.sId.lastIndexOf("-"))]=s}t.open()},_onHandleFilterItem:function(e){var t=e.getParameters();var s=e.getParameter("itemData");if(t.reason==="added"){this["_oFilterModel"+this.sId.substr(this.sId.lastIndexOf("-"))].getProperty("/filterItems").push({key:t.key,exclude:s.exclude,columnKey:s.columnKey,operation:s.operation,value1:isNaN(s.value1)?s.value1:Number(s.value1),value2:isNaN(s.value2)?s.value2:Number(s.value2)})}else{var i=this["_oFilterModel"+this.sId.substr(this.sId.lastIndexOf("-"))].getProperty("/filterItems");for(var l=0;l<i.length;l++){if(i[l].key===t.key){if(t.reason==="updated"){i[l].columnKey=s.columnKey;i[l].value1=isNaN(s.value1)?s.value1:Number(s.value1);i[l].value2=isNaN(s.value2)?s.value2:Number(s.value2);i[l].operation=s.operation}else if(t.reason==="removed"){i.splice(l,1)}break}}}},renderer:{}})});